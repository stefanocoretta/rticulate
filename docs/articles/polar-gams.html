<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Using generalised additive models (GAM) with polar coordinates for assessing tongue contours • rticulate</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Using generalised additive models (GAM) with polar coordinates for assessing tongue contours">
<meta property="og:description" content="rticulate">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rticulate</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.6.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/overview.html">Package overview</a>
    </li>
    <li>
      <a href="../articles/polar-gams.html">Using generalised additive models (GAM) with polar coordinates for assessing tongue contours</a>
    </li>
    <li>
      <a href="../articles/tongue-imaging.html">Import and plot spline data from AAA</a>
    </li>
    <li>
      <a href="../articles/transform-coord.html">Transform spline coordinates between cartesian and polar</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/stefanocoretta/rticulate/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="polar-gams_files/header-attrs-2.6/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Using generalised additive models (GAM) with polar coordinates for assessing tongue contours</h1>
                        <h4 class="author">Stefano Coretta</h4>
            
            <h4 class="date">2020-12-20</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/stefanocoretta/rticulate/blob/master/vignettes/polar-gams.Rmd"><code>vignettes/polar-gams.Rmd</code></a></small>
      <div class="hidden name"><code>polar-gams.Rmd</code></div>

    </div>

    
    
<div id="read-data" class="section level1">
<h1 class="hasAnchor">
<a href="#read-data" class="anchor"></a>Read data</h1>
<p>The package <code>rticulate</code> comes with a dataset containing spline data from two speakers of Italian.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/stefanocoretta/rticulate">rticulate</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">tongue</span><span class="op">)</span>
<span class="va">tongue</span>
<span class="co">#&gt; # A tibble: 3,612 x 28</span>
<span class="co">#&gt;    speaker seconds rec_date prompt label TT_displacement TT_velocity</span>
<span class="co">#&gt;    &lt;fct&gt;     &lt;dbl&gt; &lt;fct&gt;    &lt;fct&gt;  &lt;fct&gt;           &lt;dbl&gt;       &lt;dbl&gt;</span>
<span class="co">#&gt;  1 it01       1.31 29/11/2… Dico … max_…            67.1       36.6 </span>
<span class="co">#&gt;  2 it01       1.20 29/11/2… Dico … max_…            77.9       -7.73</span>
<span class="co">#&gt;  3 it01       1.08 29/11/2… Dico … max_…            65.9       21.1 </span>
<span class="co">#&gt;  4 it01       1.12 29/11/2… Dico … max_…            64.4        8.76</span>
<span class="co">#&gt;  5 it01       1.42 29/11/2… Dico … max_…            76.9       -4.72</span>
<span class="co">#&gt;  6 it01       1.35 29/11/2… Dico … max_…            78.1       -5.68</span>
<span class="co">#&gt;  7 it01       1.07 29/11/2… Dico … max_…            69.9      -40.0 </span>
<span class="co">#&gt;  8 it01       1.17 29/11/2… Dico … max_…            78.0       -7.31</span>
<span class="co">#&gt;  9 it01       1.28 29/11/2… Dico … max_…            67.1       34.5 </span>
<span class="co">#&gt; 10 it01       1.10 29/11/2… Dico … max_…            75.9      -23.5 </span>
<span class="co">#&gt; # … with 3,602 more rows, and 21 more variables: TT_abs_velocity &lt;dbl&gt;,</span>
<span class="co">#&gt; #   TD_displacement &lt;dbl&gt;, TD_velocity &lt;dbl&gt;, TD_abs_velocity &lt;dbl&gt;,</span>
<span class="co">#&gt; #   TR_displacement &lt;dbl&gt;, TR_velocity &lt;dbl&gt;, TR_abs_velocity &lt;dbl&gt;,</span>
<span class="co">#&gt; #   fan_line &lt;int&gt;, X &lt;dbl&gt;, Y &lt;dbl&gt;, word &lt;fct&gt;, item &lt;dbl&gt;, ipa &lt;fct&gt;,</span>
<span class="co">#&gt; #   c1 &lt;fct&gt;, c1_phonation &lt;fct&gt;, vowel &lt;fct&gt;, anteropost &lt;fct&gt;, height &lt;fct&gt;,</span>
<span class="co">#&gt; #   c2 &lt;fct&gt;, c2_phonation &lt;fct&gt;, c2_place &lt;fct&gt;</span></code></pre></div>
</div>
<div id="fit-a-polar-gam" class="section level1">
<h1 class="hasAnchor">
<a href="#fit-a-polar-gam" class="anchor"></a>Fit a polar GAM</h1>
<p>The spline data is in cartesian coordinates. The function <code><a href="../reference/polar_gam.html">polar_gam()</a></code> converts the coordinates to polar and fits a GAM to the data. Note that, unless you have a working method to normalise between speakers, it is recommended to fit separate models for each speaker.</p>
<p>The polar coordinates are calculated based on the origin of the probe, which is estimated if <code>origin = NULL</code> using the fan lines specified with the argument <code>fan_lines</code> (the defaults are <code><a href="https://rdrr.io/r/base/c.html">c(10, 25)</a></code>).</p>
<p>If you get an error relating to <code>lm.fit</code>, try to change the <code>fan_lines</code> to values different from the default.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tongue_it05</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">tongue</span>, <span class="va">speaker</span> <span class="op">==</span> <span class="st">"it05"</span>, <span class="va">vowel</span> <span class="op">==</span> <span class="st">"a"</span>, <span class="va">fan_line</span> <span class="op">&lt;</span> <span class="fl">38</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/droplevels.html">droplevels</a></span><span class="op">(</span><span class="op">)</span>

<span class="va">polar_place</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/polar_gam.html">polar_gam</a></span><span class="op">(</span>
  <span class="va">Y</span> <span class="op">~</span>
    <span class="fu">s</span><span class="op">(</span><span class="va">X</span>, by <span class="op">=</span> <span class="va">c2_place</span><span class="op">)</span>,
  data <span class="op">=</span> <span class="va">tongue_it05</span>
<span class="op">)</span>
<span class="co">#&gt; The origin is x = 11.028937677505, y = -53.2813982686628.</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">polar_place</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Family: gaussian </span>
<span class="co">#&gt; Link function: identity </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Formula:</span>
<span class="co">#&gt; Y ~ s(X, by = c2_place)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Parametric coefficients:</span>
<span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="co">#&gt; (Intercept) 62.75772    0.08464   741.5   &lt;2e-16 ***</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Approximate significance of smooth terms:</span>
<span class="co">#&gt;                        edf Ref.df     F p-value    </span>
<span class="co">#&gt; s(X):c2_placecoronal 4.576  5.614 142.7  &lt;2e-16 ***</span>
<span class="co">#&gt; s(X):c2_placevelar   7.993  8.732 372.2  &lt;2e-16 ***</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; R-sq.(adj) =  0.934   Deviance explained = 93.6%</span>
<span class="co">#&gt; fREML = 534.93  Scale est. = 2.0697    n = 289</span></code></pre></div>
<p>The output model is in polar coordinates but it contains the origin coordinates so that plotting can be done in cartesian coordinates.</p>
<p>We can now plot the results from the model with <code><a href="../reference/plot_polar_smooths.html">plot_polar_smooths()</a></code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_polar_smooths.html">plot_polar_smooths</a></span><span class="op">(</span>
  <span class="va">polar_place</span>,
  <span class="va">X</span>,
  <span class="va">c2_place</span>
<span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span></code></pre></div>
<p><img src="polar-gams_files/figure-html/plot-smooths-1.png" width="672"></p>
</div>
<div id="multiple-predictors" class="section level1">
<h1 class="hasAnchor">
<a href="#multiple-predictors" class="anchor"></a>Multiple predictors</h1>
<p>It is possible to specify multiple predictors in the model and then facet the plots.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tongue_it05</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">tongue</span>, <span class="va">speaker</span> <span class="op">==</span> <span class="st">"it05"</span>, <span class="va">fan_line</span> <span class="op">&lt;</span> <span class="fl">38</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/droplevels.html">droplevels</a></span><span class="op">(</span><span class="op">)</span>

<span class="va">polar_multi</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/polar_gam.html">polar_gam</a></span><span class="op">(</span>
  <span class="va">Y</span> <span class="op">~</span>
    <span class="fu">s</span><span class="op">(</span><span class="va">X</span>, by <span class="op">=</span> <span class="va">c2_place</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">s</span><span class="op">(</span><span class="va">X</span>, by <span class="op">=</span> <span class="va">vowel</span><span class="op">)</span>,
  data <span class="op">=</span> <span class="va">tongue_it05</span>
<span class="op">)</span>
<span class="co">#&gt; The origin is x = 11.0276270964655, y = -53.2776157001125.</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">polar_multi</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Family: gaussian </span>
<span class="co">#&gt; Link function: identity </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Formula:</span>
<span class="co">#&gt; Y ~ s(X, by = c2_place) + s(X, by = vowel)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Parametric coefficients:</span>
<span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="co">#&gt; (Intercept)  61.9700     0.0768   806.9   &lt;2e-16 ***</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Approximate significance of smooth terms:</span>
<span class="co">#&gt;                        edf Ref.df      F  p-value    </span>
<span class="co">#&gt; s(X):c2_placecoronal 5.583  6.597  3.827 0.000724 ***</span>
<span class="co">#&gt; s(X):c2_placevelar   6.925  7.784  8.564  &lt; 2e-16 ***</span>
<span class="co">#&gt; s(X):vowela          3.825  4.746  2.219 0.042102 *  </span>
<span class="co">#&gt; s(X):vowelo          2.573  3.003  2.176 0.086926 .  </span>
<span class="co">#&gt; s(X):vowelu          6.835  7.774 10.861  &lt; 2e-16 ***</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Rank: 45/46</span>
<span class="co">#&gt; R-sq.(adj) =  0.915   Deviance explained = 91.8%</span>
<span class="co">#&gt; fREML = 1986.9  Scale est. = 5.1237    n = 872</span></code></pre></div>
<p>Th argument <code>facet_terms</code> can be used to specify the terms for the facets. If you desire to facet by more then one term, just add multiple terms separated by <code><a href="https://rdrr.io/r/base/Arithmetic.html">+</a></code> (for example, <code>facet_terms = vowel + voicing</code>; only terms that have been included in the model can be used for faceting, for more examples see the vignettes of the tidymv package).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_polar_smooths.html">plot_polar_smooths</a></span><span class="op">(</span>
  <span class="va">polar_multi</span>,
  <span class="va">X</span>,
  <span class="va">c2_place</span>,
  facet_terms <span class="op">=</span> <span class="va">vowel</span>
<span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span></code></pre></div>
<p><img src="polar-gams_files/figure-html/plot-smooths-2-1.png" width="672"></p>
</div>
<div id="extract-all-predicted-values" class="section level1">
<h1 class="hasAnchor">
<a href="#extract-all-predicted-values" class="anchor"></a>Extract all predicted values</h1>
<p>If your model includes other smooths, or you want to have more control over the plotting, you can use the function <code><a href="../reference/predict_polar_gam.html">predict_polar_gam()</a></code>. This function is based on <code><a href="https://rdrr.io/pkg/tidymv/man/predict_gam.html">tidymv::predict_gam()</a></code>, and I suggest the reader to familiarise themselves with <code>vignette("predict-gam", package = "tidymv")</code>.</p>
<p>For example, let’s add a smooth to the model we used above and an interaction of this smooth with the one over <code>X</code>. For illustrative purposes, we will set up a smooth over <code>TR_abs_velocity</code>, which is the absolute velocity of the tongue root at the time point the tongue contour was extracted (note that this analysis might not make sense, and it is given here only to show how to extract the predictions). We also include a random smooth for word, which we will exclude later when we extract the predictions.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">polar_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/polar_gam.html">polar_gam</a></span><span class="op">(</span>
  <span class="va">Y</span> <span class="op">~</span>
    <span class="fu">s</span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">s</span><span class="op">(</span><span class="va">X</span>, by <span class="op">=</span> <span class="va">c2_place</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">s</span><span class="op">(</span><span class="va">TR_abs_velocity</span>, k <span class="op">=</span> <span class="fl">6</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">ti</span><span class="op">(</span><span class="va">X</span>, <span class="va">TR_abs_velocity</span>, k <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">9</span>, <span class="fl">6</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">s</span><span class="op">(</span><span class="va">X</span>, <span class="va">word</span>, bs <span class="op">=</span> <span class="st">"fs"</span><span class="op">)</span>,
  data <span class="op">=</span> <span class="va">tongue_it05</span>
<span class="op">)</span>
<span class="co">#&gt; The origin is x = 11.0276270964655, y = -53.2776157001125.</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">polar_2</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Family: gaussian </span>
<span class="co">#&gt; Link function: identity </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Formula:</span>
<span class="co">#&gt; Y ~ s(X) + s(X, by = c2_place) + s(TR_abs_velocity, k = 6) + </span>
<span class="co">#&gt;     ti(X, TR_abs_velocity, k = c(9, 6)) + s(X, word, bs = "fs")</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Parametric coefficients:</span>
<span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="co">#&gt; (Intercept)   61.335      3.236   18.95   &lt;2e-16 ***</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Approximate significance of smooth terms:</span>
<span class="co">#&gt;                          edf Ref.df      F  p-value    </span>
<span class="co">#&gt; s(X)                   6.795  7.314  3.878 0.000262 ***</span>
<span class="co">#&gt; s(X):c2_placecoronal   1.000  1.000  0.019 0.889360    </span>
<span class="co">#&gt; s(X):c2_placevelar     3.302  3.759  2.035 0.092428 .  </span>
<span class="co">#&gt; s(TR_abs_velocity)     3.764  4.396  4.666 0.000486 ***</span>
<span class="co">#&gt; ti(X,TR_abs_velocity) 23.323 28.418  5.521  &lt; 2e-16 ***</span>
<span class="co">#&gt; s(X,word)             31.803 57.000 26.612  &lt; 2e-16 ***</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Rank: 132/133</span>
<span class="co">#&gt; R-sq.(adj) =  0.959   Deviance explained = 96.3%</span>
<span class="co">#&gt; fREML = 1751.8  Scale est. = 2.4443    n = 872</span></code></pre></div>
<p>We can now obtain the predicted tongue contours. We set specific values for <code>TR_abs_velocity</code> using the <code>values</code> argument. Since we included a random smooth, which we want to remove now, we can do so by using <code>exclude_terms</code>. To learn how this argument works in detail, see <code>vignette("predict-gam", package = "tidymv")</code>. Note that you have to filter the output to remove repeated data (which arise because we are excluding a term, i.e. we set its coefficient to 0).</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">polar_pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict_polar_gam.html">predict_polar_gam</a></span><span class="op">(</span>
  <span class="va">polar_2</span>,
  values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>TR_abs_velocity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">24</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span>,
  exclude_terms <span class="op">=</span> <span class="st">"s(X,word)"</span>
<span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">word</span> <span class="op">==</span> <span class="st">"paca"</span><span class="op">)</span> <span class="co"># filter data by choosing any value for word</span>

<span class="va">polar_pred</span>
<span class="co">#&gt; # A tibble: 500 x 6</span>
<span class="co">#&gt;    c2_place TR_abs_velocity word  se.fit     X     Y</span>
<span class="co">#&gt;    &lt;fct&gt;              &lt;dbl&gt; &lt;fct&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt;  1 coronal                2 paca    8.54  30.8  9.04</span>
<span class="co">#&gt;  2 coronal                2 paca    8.23  29.3  9.23</span>
<span class="co">#&gt;  3 coronal                2 paca    7.91  27.9  9.40</span>
<span class="co">#&gt;  4 coronal                2 paca    7.61  26.4  9.55</span>
<span class="co">#&gt;  5 coronal                2 paca    7.31  25.0  9.70</span>
<span class="co">#&gt;  6 coronal                2 paca    7.01  23.5  9.86</span>
<span class="co">#&gt;  7 coronal                2 paca    6.71  22.1 10.0 </span>
<span class="co">#&gt;  8 coronal                2 paca    6.41  20.7 10.2 </span>
<span class="co">#&gt;  9 coronal                2 paca    6.12  19.3 10.5 </span>
<span class="co">#&gt; 10 coronal                2 paca    5.83  17.9 10.7 </span>
<span class="co">#&gt; # … with 490 more rows</span></code></pre></div>
<p>And now we can plot using standard <code>ggplot2</code> functions.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">polar_pred</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">X</span>, <span class="va">Y</span>, colour <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">TR_abs_velocity</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">TR_abs_velocity</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_path</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_grid</span><span class="op">(</span><span class="va">c2_place</span> <span class="op">~</span> <span class="va">.</span><span class="op">)</span></code></pre></div>
<p><img src="polar-gams_files/figure-html/place-pred-plot-1.png" width="672"></p>
<div id="plotting-the-curve-with-confidence-intervals" class="section level2">
<h2 class="hasAnchor">
<a href="#plotting-the-curve-with-confidence-intervals" class="anchor"></a>Plotting the curve with confidence intervals</h2>
<p>If you want to add confidence intervals to the fitted curve, you have to get both the coordinates of the fitted curves using <code><a href="../reference/predict_polar_gam.html">predict_polar_gam(model)</a></code> and the coordinates of the confidence intervals with <code><a href="../reference/predict_polar_gam.html">predict_polar_gam(model, return_ci = TRUE)</a></code>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">polar_multi_p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict_polar_gam.html">predict_polar_gam</a></span><span class="op">(</span>
  <span class="va">polar_multi</span>
<span class="op">)</span>

<span class="va">ci_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict_polar_gam.html">predict_polar_gam</a></span><span class="op">(</span>
  <span class="va">polar_multi</span>,
  return_ci <span class="op">=</span> <span class="cn">TRUE</span>,
<span class="op">)</span></code></pre></div>
<p>Now you can use the prediction dataset as the global data and the CI data with <code>geom_polygon()</code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">polar_multi_p</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">X</span>, <span class="va">Y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_polygon</span><span class="op">(</span>data <span class="op">=</span> <span class="va">ci_data</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">CI_X</span>, <span class="va">CI_Y</span>, group <span class="op">=</span> <span class="va">c2_place</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_path</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>colour <span class="op">=</span> <span class="va">c2_place</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_grid</span><span class="op">(</span><span class="va">.</span> <span class="op">~</span> <span class="va">vowel</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span></code></pre></div>
<p><img src="polar-gams_files/figure-html/place-pred-ci-1.png" width="672"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Stefano Coretta.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
