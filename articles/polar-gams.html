<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Using generalised additive models (GAM) with polar coordinates for assessing tongue contours • rticulate</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Using generalised additive models (GAM) with polar coordinates for assessing tongue contours">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">rticulate</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/filter-signals.html">Filter signals</a></li>
    <li><a class="dropdown-item" href="../articles/kinematics.html">Kinematics and gestural landmarks</a></li>
    <li><a class="dropdown-item" href="../articles/overview.html">Package overview</a></li>
    <li><a class="dropdown-item" href="../articles/polar-gams.html">Using generalised additive models (GAM) with polar coordinates for assessing tongue contours</a></li>
    <li><a class="dropdown-item" href="../articles/tongue-imaging.html">Import and plot UTI and EMA data</a></li>
    <li><a class="dropdown-item" href="../articles/transform-coord.html">Transform spline coordinates between cartesian and polar</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/stefanocoretta/rticulate/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Using generalised additive models (GAM) with polar coordinates for assessing tongue contours</h1>
                        <h4 data-toc-skip class="author">Stefano
Coretta</h4>
            
            <h4 data-toc-skip class="date">2025-02-20</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/stefanocoretta/rticulate/blob/main/vignettes/polar-gams.Rmd" class="external-link"><code>vignettes/polar-gams.Rmd</code></a></small>
      <div class="d-none name"><code>polar-gams.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="read-data">Read data<a class="anchor" aria-label="anchor" href="#read-data"></a>
</h2>
<p>The package <code>rticulate</code> comes with a dataset containing
spline data from two speakers of Italian.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/stefanocoretta/rticulate" class="external-link">rticulate</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">tongue</span><span class="op">)</span></span>
<span><span class="va">tongue</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3,612 × 28</span></span></span>
<span><span class="co">#&gt;    speaker seconds rec_date            prompt  label TT_displacement TT_velocity</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> it01       1.31 29/11/2016 15:10:57 Dico p… max_…            67.1       36.6 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> it01       1.20 29/11/2016 15:11:03 Dico p… max_…            77.9       -<span style="color: #BB0000;">7.73</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> it01       1.08 29/11/2016 15:11:25 Dico p… max_…            65.9       21.1 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> it01       1.12 29/11/2016 15:11:35 Dico p… max_…            64.4        8.76</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> it01       1.42 29/11/2016 15:11:57 Dico p… max_…            76.9       -<span style="color: #BB0000;">4.72</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> it01       1.35 29/11/2016 15:12:53 Dico p… max_…            78.1       -<span style="color: #BB0000;">5.68</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> it01       1.07 29/11/2016 15:13:44 Dico p… max_…            69.9      -<span style="color: #BB0000;">40.0</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> it01       1.17 29/11/2016 15:13:49 Dico p… max_…            78.0       -<span style="color: #BB0000;">7.31</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> it01       1.28 29/11/2016 15:14:11 Dico p… max_…            67.1       34.5 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> it01       1.10 29/11/2016 15:14:22 Dico p… max_…            75.9      -<span style="color: #BB0000;">23.5</span> </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 3,602 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 21 more variables: TT_abs_velocity &lt;dbl&gt;, TD_displacement &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   TD_velocity &lt;dbl&gt;, TD_abs_velocity &lt;dbl&gt;, TR_displacement &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   TR_velocity &lt;dbl&gt;, TR_abs_velocity &lt;dbl&gt;, fan_line &lt;int&gt;, X &lt;dbl&gt;, Y &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   word &lt;fct&gt;, item &lt;dbl&gt;, ipa &lt;fct&gt;, c1 &lt;fct&gt;, c1_phonation &lt;fct&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   vowel &lt;fct&gt;, anteropost &lt;fct&gt;, height &lt;fct&gt;, c2 &lt;fct&gt;, c2_phonation &lt;fct&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   c2_place &lt;fct&gt;</span></span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="fit-a-polar-gam">Fit a polar GAM<a class="anchor" aria-label="anchor" href="#fit-a-polar-gam"></a>
</h2>
<p>The spline data is in cartesian coordinates. The function
<code><a href="../reference/polar_gam.html">polar_gam()</a></code> converts the coordinates to polar and fits a
GAM to the data. Note that, unless you have a working method to
normalise between speakers, it is recommended to fit separate models for
each speaker.</p>
<p>The polar coordinates are calculated based on the origin of the
probe, which is estimated if <code>origin = NULL</code> using the fan
lines specified with the argument <code>fan_lines</code> (the defaults
are <code>c(10, 25)</code>).</p>
<p>If you get an error relating to <code>lm.fit</code>, try to change
the <code>fan_lines</code> to values different from the default.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tongue_it05</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">tongue</span>, <span class="va">speaker</span> <span class="op">==</span> <span class="st">"it05"</span>, <span class="va">vowel</span> <span class="op">==</span> <span class="st">"a"</span>, <span class="va">fan_line</span> <span class="op">&lt;</span> <span class="fl">38</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/droplevels.html" class="external-link">droplevels</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">polar_place</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/polar_gam.html">polar_gam</a></span><span class="op">(</span></span>
<span>  <span class="va">Y</span> <span class="op">~</span></span>
<span>    <span class="fu">s</span><span class="op">(</span><span class="va">X</span>, by <span class="op">=</span> <span class="va">c2_place</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">tongue_it05</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; The origin is x = 11.028937677505, y = -53.2813982686628.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">polar_place</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Family: gaussian </span></span>
<span><span class="co">#&gt; Link function: identity </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Formula:</span></span>
<span><span class="co">#&gt; Y ~ s(X, by = c2_place)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parametric coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept) 62.75772    0.08464   741.5   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Approximate significance of smooth terms:</span></span>
<span><span class="co">#&gt;                        edf Ref.df     F p-value    </span></span>
<span><span class="co">#&gt; s(X):c2_placecoronal 4.576  5.614 142.7  &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; s(X):c2_placevelar   7.993  8.732 372.2  &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; R-sq.(adj) =  0.934   Deviance explained = 93.6%</span></span>
<span><span class="co">#&gt; fREML = 534.93  Scale est. = 2.0697    n = 289</span></span></code></pre></div>
<p>The output model is in polar coordinates but it contains the origin
coordinates so that plotting can be done in cartesian coordinates.</p>
</div>
<div class="section level2">
<h2 id="multiple-predictors">Multiple predictors<a class="anchor" aria-label="anchor" href="#multiple-predictors"></a>
</h2>
<p>It is possible to specify multiple predictors in the model and then
facet the plots.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tongue_it05</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">tongue</span>, <span class="va">speaker</span> <span class="op">==</span> <span class="st">"it05"</span>, <span class="va">fan_line</span> <span class="op">&lt;</span> <span class="fl">38</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/droplevels.html" class="external-link">droplevels</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">polar_multi</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/polar_gam.html">polar_gam</a></span><span class="op">(</span></span>
<span>  <span class="va">Y</span> <span class="op">~</span></span>
<span>    <span class="fu">s</span><span class="op">(</span><span class="va">X</span>, by <span class="op">=</span> <span class="va">c2_place</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">s</span><span class="op">(</span><span class="va">X</span>, by <span class="op">=</span> <span class="va">vowel</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">tongue_it05</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; The origin is x = 11.0276270964655, y = -53.2776157001125.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">polar_multi</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Family: gaussian </span></span>
<span><span class="co">#&gt; Link function: identity </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Formula:</span></span>
<span><span class="co">#&gt; Y ~ s(X, by = c2_place) + s(X, by = vowel)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parametric coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)  61.9700     0.0768   806.9   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Approximate significance of smooth terms:</span></span>
<span><span class="co">#&gt;                        edf Ref.df      F  p-value    </span></span>
<span><span class="co">#&gt; s(X):c2_placecoronal 5.583  6.597  3.827 0.000724 ***</span></span>
<span><span class="co">#&gt; s(X):c2_placevelar   6.925  7.784  8.564  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; s(X):vowela          3.825  4.746  2.219 0.042102 *  </span></span>
<span><span class="co">#&gt; s(X):vowelo          2.573  3.003  2.176 0.086926 .  </span></span>
<span><span class="co">#&gt; s(X):vowelu          6.835  7.774 10.861  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Rank: 45/46</span></span>
<span><span class="co">#&gt; R-sq.(adj) =  0.915   Deviance explained = 91.8%</span></span>
<span><span class="co">#&gt; fREML = 1986.9  Scale est. = 5.1237    n = 872</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="extract-all-predicted-values">Extract all predicted values<a class="anchor" aria-label="anchor" href="#extract-all-predicted-values"></a>
</h2>
<p>If your model includes other smooths, or you want to have more
control over the plotting, you can use the function
<code><a href="../reference/predict_polar_gam.html">predict_polar_gam()</a></code>. This function is based on
<code>tidymv::predict_gam()</code>, and I suggest the reader to
familiarise themselves with
<code>vignette("predict-gam", package = "tidymv")</code>.</p>
<p>For example, let’s add a smooth to the model we used above and an
interaction of this smooth with the one over <code>X</code>. For
illustrative purposes, we will set up a smooth over
<code>TR_abs_velocity</code>, which is the absolute velocity of the
tongue root at the time point the tongue contour was extracted (note
that this analysis might not make sense, and it is given here only to
show how to extract the predictions). We also include a random smooth
for word, which we will exclude later when we extract the
predictions.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">polar_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/polar_gam.html">polar_gam</a></span><span class="op">(</span></span>
<span>  <span class="va">Y</span> <span class="op">~</span></span>
<span>    <span class="fu">s</span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">s</span><span class="op">(</span><span class="va">X</span>, by <span class="op">=</span> <span class="va">c2_place</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">s</span><span class="op">(</span><span class="va">TR_abs_velocity</span>, k <span class="op">=</span> <span class="fl">6</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ti</span><span class="op">(</span><span class="va">X</span>, <span class="va">TR_abs_velocity</span>, k <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">9</span>, <span class="fl">6</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">s</span><span class="op">(</span><span class="va">X</span>, <span class="va">word</span>, bs <span class="op">=</span> <span class="st">"fs"</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">tongue_it05</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; The origin is x = 11.0276270964655, y = -53.2776157001125.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">polar_2</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Family: gaussian </span></span>
<span><span class="co">#&gt; Link function: identity </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Formula:</span></span>
<span><span class="co">#&gt; Y ~ s(X) + s(X, by = c2_place) + s(TR_abs_velocity, k = 6) + </span></span>
<span><span class="co">#&gt;     ti(X, TR_abs_velocity, k = c(9, 6)) + s(X, word, bs = "fs")</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parametric coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)  61.6338     0.5287   116.6   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Approximate significance of smooth terms:</span></span>
<span><span class="co">#&gt;                           edf Ref.df      F  p-value    </span></span>
<span><span class="co">#&gt; s(X)                   7.2007  7.672  5.111 5.18e-06 ***</span></span>
<span><span class="co">#&gt; s(X):c2_placecoronal   1.0000  1.000  2.009 0.156712    </span></span>
<span><span class="co">#&gt; s(X):c2_placevelar     0.9186  1.069  0.275 0.721573    </span></span>
<span><span class="co">#&gt; s(TR_abs_velocity)     3.8178  4.436  4.833 0.000333 ***</span></span>
<span><span class="co">#&gt; ti(X,TR_abs_velocity) 23.0822 28.164  5.503  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; s(X,word)             35.5012 57.000 27.256  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Rank: 132/133</span></span>
<span><span class="co">#&gt; R-sq.(adj) =   0.96   Deviance explained = 96.3%</span></span>
<span><span class="co">#&gt; fREML = 1739.7  Scale est. = 2.4364    n = 872</span></span></code></pre></div>
<p>We can now obtain the predicted tongue contours. We set specific
values for <code>TR_abs_velocity</code> using the <code>values</code>
argument. Since we included a random smooth, which we want to remove
now, we can do so by using <code>exclude_terms</code>. To learn how this
argument works in detail, see
<code>vignette("predict-gam", package = "tidymv")</code>. Note that you
have to filter the output to remove repeated data (which arise because
we are excluding a term, i.e. we set its coefficient to 0).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">polar_pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict_polar_gam.html">predict_polar_gam</a></span><span class="op">(</span></span>
<span>  <span class="va">polar_2</span>,</span>
<span>  values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>TR_abs_velocity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">24</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  exclude_terms <span class="op">=</span> <span class="st">"s(X,word)"</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">word</span> <span class="op">==</span> <span class="st">"paca"</span><span class="op">)</span> <span class="co"># filter data by choosing any value for word</span></span>
<span></span>
<span><span class="va">polar_pred</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 500 × 6</span></span></span>
<span><span class="co">#&gt;    c2_place TR_abs_velocity word  se.fit     X     Y</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> coronal                2 paca    2.78  31.0  9.75</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> coronal                2 paca    2.53  29.6 10.0 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> coronal                2 paca    2.30  28.1 10.3 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> coronal                2 paca    2.10  26.7 10.5 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> coronal                2 paca    1.92  25.2 10.8 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> coronal                2 paca    1.76  23.8 11.0 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> coronal                2 paca    1.62  22.3 11.3 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> coronal                2 paca    1.49  20.9 11.5 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> coronal                2 paca    1.39  19.5 11.8 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> coronal                2 paca    1.32  18.0 12.1 </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 490 more rows</span></span></span></code></pre></div>
<p>And now we can plot using standard <code>ggplot2</code>
functions.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">polar_pred</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">Y</span>, colour <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">TR_abs_velocity</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">TR_abs_velocity</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_path</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">c2_place</span> <span class="op">~</span> <span class="va">.</span><span class="op">)</span></span></code></pre></div>
<p><img src="polar-gams_files/figure-html/place-pred-plot-1.png" width="672"></p>
<div class="section level3">
<h3 id="plotting-the-curve-with-confidence-intervals">Plotting the curve with confidence intervals<a class="anchor" aria-label="anchor" href="#plotting-the-curve-with-confidence-intervals"></a>
</h3>
<p>If you want to add confidence intervals to the fitted curve, you have
to get both the coordinates of the fitted curves using
<code>predict_polar_gam(model)</code> and the coordinates of the
confidence intervals with
<code>predict_polar_gam(model, return_ci = TRUE)</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">polar_multi_p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict_polar_gam.html">predict_polar_gam</a></span><span class="op">(</span></span>
<span>  <span class="va">polar_multi</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">ci_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict_polar_gam.html">predict_polar_gam</a></span><span class="op">(</span></span>
<span>  <span class="va">polar_multi</span>,</span>
<span>  return_ci <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span><span class="op">)</span></span></code></pre></div>
<p>Now you can use the prediction dataset as the global data and the CI
data with <code><a href="https://ggplot2.tidyverse.org/reference/geom_polygon.html" class="external-link">geom_polygon()</a></code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">polar_multi_p</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">Y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_polygon.html" class="external-link">geom_polygon</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ci_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">CI_X</span>, <span class="va">CI_Y</span>, group <span class="op">=</span> <span class="va">c2_place</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_path</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="va">c2_place</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">.</span> <span class="op">~</span> <span class="va">vowel</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span></span></code></pre></div>
<p><img src="polar-gams_files/figure-html/place-pred-ci-1.png" width="672"></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Stefano Coretta.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
