<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Filter signals • rticulate</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Filter signals">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">rticulate</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/filter-signals.html">Filter signals</a></li>
    <li><a class="dropdown-item" href="../articles/kinematics.html">Kinematics and gestural landmarks</a></li>
    <li><a class="dropdown-item" href="../articles/overview.html">Package overview</a></li>
    <li><a class="dropdown-item" href="../articles/polar-gams.html">Using generalised additive models (GAM) with polar coordinates for assessing tongue contours</a></li>
    <li><a class="dropdown-item" href="../articles/tongue-imaging.html">Import and plot spline data from AAA</a></li>
    <li><a class="dropdown-item" href="../articles/transform-coord.html">Transform spline coordinates between cartesian and polar</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/stefanocoretta/rticulate/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Filter signals</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/stefanocoretta/rticulate/blob/main/vignettes/filter-signals.Rmd" class="external-link"><code>vignettes/filter-signals.Rmd</code></a></small>
      <div class="d-none name"><code>filter-signals.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette illustrates how to smooth articulator displacement
signals using Savitzky-Golay or Butterworth filters, and how to resample
(usually, upsample) the signals.</p>
<p>First, let’s attach the tidyverse packages and rticulate.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Attaching core tidyverse packages</span> ──────────────────────── tidyverse 2.0.0 ──</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">dplyr    </span> 1.1.4     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">readr    </span> 2.1.5</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">forcats  </span> 1.0.0     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">stringr  </span> 1.5.1</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">ggplot2  </span> 3.5.1     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">tibble   </span> 3.2.1</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">lubridate</span> 1.9.4     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">tidyr    </span> 1.3.1</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">purrr    </span> 1.0.4     </span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Conflicts</span> ────────────────────────────────────────── tidyverse_conflicts() ──</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">filter()</span> masks <span style="color: #0000BB;">stats</span>::filter()</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">lag()</span>    masks <span style="color: #0000BB;">stats</span>::lag()</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use the conflicted package (<span style="color: #0000BB; font-style: italic;">&lt;http://conflicted.r-lib.org/&gt;</span>) to force all conflicts to become errors</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/stefanocoretta/rticulate" class="external-link">rticulate</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/Nowosad/rcartocolor" class="external-link">rcartocolor</a></span><span class="op">)</span></span></code></pre></div>
<p>Now let’s read the sample data in the file <code>it01-dlc.tsv</code>.
This file contains ultrasound tongue imaging data of an Italian speaker
uttering target words in a frame sentence. The sample data has only two
target words: <em>pata</em> and <em>pada</em>.</p>
<p>DeepLabCut was used to track 14 points (knots): 11 points on the
midsagittal tongue surface plus 3 extra points corresponding to the
hyoid bone, the base of the short tendon the base of the mandible.</p>
<p>The 11 lingual knots form the tongue spline. Two extra splines are
formed by the line connecting the hyoid knot with the mandible knot
(Hyoid-Mandible, HM) and the line connecting the short tendon knot with
the mandible knot (Short tendon-Mandible, STM).</p>
<p>The DLC-tracked points were extracted from each ultrasonic frame
within an interval that encompasses one syllable preceding the target
word, the target word, and one syllable following the target word.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">it01_dlc_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/it01-dlc.tsv"</span>, package <span class="op">=</span> <span class="st">"rticulate"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">it01_dlc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_aaa.html">read_aaa</a></span><span class="op">(</span><span class="va">it01_dlc_path</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="co"># Let's rename some columns.</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span></span>
<span>    date_time <span class="op">=</span> <span class="va">`Date Time of recording`</span>,</span>
<span>    time_rec <span class="op">=</span> <span class="va">`Time of sample in recording`</span>,</span>
<span>    time_annot <span class="op">=</span> <span class="va">`Time of sample in annot`</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">521</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">36</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Delimiter:</span> "\t"</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">chr</span>  (4): Client family name, Date Time of recording, Prompt, Annotation Title</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">dbl</span> (32): Time of sample in recording, Time of sample in annot, X0 DLC_Tongu...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use `spec()` to retrieve the full column specification for this data.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></span>
<span></span>
<span><span class="va">it01_dlc</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 7,815 × 12</span></span></span>
<span><span class="co">#&gt;    `Client family name` date_time  time_rec time_annot Prompt `Annotation Title`</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> it01                 29/11/201…    0.670     0.008<span style="text-decoration: underline;">7</span> Dico … ultrasound        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> it01                 29/11/201…    0.670     0.008<span style="text-decoration: underline;">7</span> Dico … ultrasound        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> it01                 29/11/201…    0.670     0.008<span style="text-decoration: underline;">7</span> Dico … ultrasound        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> it01                 29/11/201…    0.670     0.008<span style="text-decoration: underline;">7</span> Dico … ultrasound        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> it01                 29/11/201…    0.670     0.008<span style="text-decoration: underline;">7</span> Dico … ultrasound        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> it01                 29/11/201…    0.670     0.008<span style="text-decoration: underline;">7</span> Dico … ultrasound        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> it01                 29/11/201…    0.670     0.008<span style="text-decoration: underline;">7</span> Dico … ultrasound        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> it01                 29/11/201…    0.670     0.008<span style="text-decoration: underline;">7</span> Dico … ultrasound        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> it01                 29/11/201…    0.670     0.008<span style="text-decoration: underline;">7</span> Dico … ultrasound        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> it01                 29/11/201…    0.670     0.008<span style="text-decoration: underline;">7</span> Dico … ultrasound        </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 7,805 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 6 more variables: knot &lt;dbl&gt;, spline &lt;chr&gt;, X &lt;dbl&gt;, Y &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   frame_id &lt;int&gt;, displ_id &lt;dbl&gt;</span></span></span></code></pre></div>
<p>We will be smoothing the displacement of the tongue knots, so let’s
filter the data.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">it01_tongue</span> <span class="op">&lt;-</span> <span class="va">it01_dlc</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">spline</span> <span class="op">==</span> <span class="st">"DLC_Tongue"</span><span class="op">)</span></span></code></pre></div>
<p>Finally we can check the mean sampling frequency (frame rate) of the
data. We will need this later, for the Butterworth filter.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">it01_dlc</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">displ_id</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>dt <span class="op">=</span> <span class="va">time_annot</span> <span class="op">-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/lead-lag.html" class="external-link">lag</a></span><span class="op">(</span><span class="va">time_annot</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>mean_dt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">dt</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>mean_fs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">mean_dt</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 1</span></span></span>
<span><span class="co">#&gt;   mean_fs</span></span>
<span><span class="co">#&gt;     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>      67</span></span></code></pre></div>
<p>The mean sampling frequency is 67 frames per second, i.e. 67 Hz.</p>
<p>Let’s take a look at the displacement trajectories of knot 8 (which
tracks to the tongue blade) along the Y axis (this will roughly indicate
the tongue blade displacement to/from the from hard palate/alveolar
ridge. The purple rectangle indicates approximately the tongue tip
gesture of the second consonant of the target words <em>pata</em> and
<em>pada</em>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">it01_tongue</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">knot</span> <span class="op">==</span> <span class="st">"8"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">time_annot</span>, <span class="va">Y</span>, group <span class="op">=</span> <span class="va">date_time</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"rect"</span>,</span>
<span>           ymin <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>, ymax <span class="op">=</span> <span class="cn">Inf</span>, xmin <span class="op">=</span> <span class="fl">0.3</span>, xmax <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>           alpha <span class="op">=</span> <span class="fl">0.25</span>, fill <span class="op">=</span> <span class="st">"purple"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="filter-signals_files/figure-html/it01-tongue-plot-1.png" width="672"></p>
<p>The displacement trajectories are very jagged, due to imprecisions in
the DLC tracking algorithm.</p>
<p>Let’s proceed to smooth the trajectory using filtering techniques
from signal processing. Here, we will use a Savitzky-Golay filter and a
Butterworth filter.</p>
</div>
<div class="section level2">
<h2 id="savitzky-golay-filter">Savitzky-Golay filter<a class="anchor" aria-label="anchor" href="#savitzky-golay-filter"></a>
</h2>
<p>A Savitzky-Golay filter fits local polynomial regressions and usually
produces great results. The user has to specify the polynomial order and
the length of the moving window used in the fitting procedure (i.e. the
number of consecutive observations to use).</p>
<p>The default order (second-order, <code>2</code>) is generally fine.
As for the window length, we recommend trying a few lengths and picking
a length that visually generates smoothed curves that are a good
compromise between smoothing the original jagged signal without creating
obvious artefacts (such as very different amplitudes in peaks and
valleys). The larger the window, the greater the smoothing effect. Note
that the window length is dependent on the sampling frequency: greater
sampling frequencies require winder windows.</p>
<p>In the following code, we plot the result of smoothing one signal
using a window length of 5, 7, 8, 11, and 15. Ideally you would want to
do this for a bunch of trajectories.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sg_plot</span> <span class="op">&lt;-</span> <span class="va">it01_tongue</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">displ_id</span> <span class="op">==</span> <span class="fl">29</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">time_annot</span>, <span class="va">Y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">wl</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">7</span>, <span class="fl">9</span>, <span class="fl">11</span>, <span class="fl">15</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">sg_plot</span> <span class="op">&lt;-</span> <span class="va">sg_plot</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>        y <span class="op">=</span> <span class="fu"><a href="../reference/filter_signal.html">filter_signal</a></span><span class="op">(</span><span class="va">Y</span>, order <span class="op">=</span> <span class="fl">2</span>, window_length <span class="op">=</span> <span class="op">{</span><span class="op">{</span> <span class="va">wl</span> <span class="op">}</span><span class="op">}</span>, apply <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>        colour <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="op">{</span><span class="op">{</span> <span class="va">wl</span> <span class="op">}</span><span class="op">}</span><span class="op">)</span></span>
<span>      <span class="op">)</span>, linewidth <span class="op">=</span> <span class="fl">1.5</span>, alpha <span class="op">=</span> <span class="fl">0.7</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">sg_plot</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/rcartocolor/man/carto_scale.html" class="external-link">scale_colour_carto_d</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Safe"</span>, name <span class="op">=</span> <span class="st">"Window\nlength"</span><span class="op">)</span></span></code></pre></div>
<p><img src="filter-signals_files/figure-html/filter-sg-test-1.png" width="672"></p>
<p>A window length of 11 and 15 clearly distorts the original signal,
while 5 and 7 work generally well. Let’s go with 7.</p>
<p>It’s important to remember to group the data by <code>displ_id</code>
when mutating, so that smoothing is applied to each displacement signal
individually (below, we do it with the new <code>.by</code>
argument).</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">it01_tongue</span> <span class="op">&lt;-</span> <span class="va">it01_tongue</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    Y_sm <span class="op">=</span> <span class="fu"><a href="../reference/filter_signal.html">filter_signal</a></span><span class="op">(</span><span class="va">Y</span>, order <span class="op">=</span> <span class="fl">2</span>, window_length <span class="op">=</span> <span class="fl">7</span>, apply <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>    .by <span class="op">=</span> <span class="va">displ_id</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">it01_tongue</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">time_annot</span>, <span class="va">Y</span>, <span class="va">Y_sm</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5,731 × 3</span></span></span>
<span><span class="co">#&gt;    time_annot     Y  Y_sm</span></span>
<span><span class="co">#&gt;         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>     0.008<span style="text-decoration: underline;">7</span>  32.9  32.4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>     0.008<span style="text-decoration: underline;">7</span>  45.6  44.6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>     0.008<span style="text-decoration: underline;">7</span>  58.9  57.5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>     0.008<span style="text-decoration: underline;">7</span>  69.6  68.4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>     0.008<span style="text-decoration: underline;">7</span>  76.5  76.1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>     0.008<span style="text-decoration: underline;">7</span>  83.3  82.7</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>     0.008<span style="text-decoration: underline;">7</span>  79.4  79.6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>     0.008<span style="text-decoration: underline;">7</span>  75.9  76.1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>     0.008<span style="text-decoration: underline;">7</span>  71.9  72.4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>     0.008<span style="text-decoration: underline;">7</span>  69.0  67.4</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 5,721 more rows</span></span></span></code></pre></div>
<p>We can now plot the smoothed displacement trajectories on top of the
original ones.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">it01_tongue</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">knot</span> <span class="op">==</span> <span class="st">"8"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">time_annot</span>, <span class="va">Y</span>, group <span class="op">=</span> <span class="va">date_time</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">Y_sm</span><span class="op">)</span>, colour <span class="op">=</span> <span class="st">"purple"</span><span class="op">)</span></span></code></pre></div>
<p><img src="filter-signals_files/figure-html/filter-sg-plog-1.png" width="672"></p>
<p>Let’s sample 9 trajectories from any knot.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">13579</span><span class="op">)</span></span>
<span><span class="va">kdi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">it01_tongue</span><span class="op">$</span><span class="va">displ_id</span><span class="op">)</span>, <span class="fl">9</span><span class="op">)</span></span>
<span></span>
<span><span class="va">it01_tongue</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">displ_id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">kdi</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">time_annot</span>, <span class="va">Y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">Y_sm</span><span class="op">)</span>, colour <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">displ_id</span><span class="op">)</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span></span></code></pre></div>
<p><img src="filter-signals_files/figure-html/filter-sg-sample-1.png" width="672"></p>
</div>
<div class="section level2">
<h2 id="butterworth">Butterworth<a class="anchor" aria-label="anchor" href="#butterworth"></a>
</h2>
<p>A Butterworth filter is a type of band filter and when set up as a
low-pass band filter it effectively removes higher frequency
fluctuations in the signal.</p>
<p>A cut-off frequency of 10-20 Hz works for most articulatory signals,
again it’s sensible to try a few values. Here we go with 10 Hz. The
sampling frequency also has to be specified.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">it01_tongue</span> <span class="op">&lt;-</span> <span class="va">it01_tongue</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    Y_smb <span class="op">=</span> <span class="fu"><a href="../reference/filter_signal.html">filter_signal</a></span><span class="op">(</span><span class="va">Y</span>, filter <span class="op">=</span> <span class="st">"butter"</span>, cutoff_freq <span class="op">=</span> <span class="fl">10</span>, sampling_freq <span class="op">=</span> <span class="fl">67</span><span class="op">)</span>,</span>
<span>    .by <span class="op">=</span> <span class="va">displ_id</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">it01_tongue</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">time_annot</span>, <span class="va">Y</span>, <span class="va">Y_smb</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5,731 × 3</span></span></span>
<span><span class="co">#&gt;    time_annot     Y Y_smb</span></span>
<span><span class="co">#&gt;         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>     0.008<span style="text-decoration: underline;">7</span>  32.9  32.9</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>     0.008<span style="text-decoration: underline;">7</span>  45.6  45.6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>     0.008<span style="text-decoration: underline;">7</span>  58.9  58.9</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>     0.008<span style="text-decoration: underline;">7</span>  69.6  69.6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>     0.008<span style="text-decoration: underline;">7</span>  76.5  76.5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>     0.008<span style="text-decoration: underline;">7</span>  83.3  83.3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>     0.008<span style="text-decoration: underline;">7</span>  79.4  79.4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>     0.008<span style="text-decoration: underline;">7</span>  75.9  75.9</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>     0.008<span style="text-decoration: underline;">7</span>  71.9  71.8</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>     0.008<span style="text-decoration: underline;">7</span>  69.0  68.9</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 5,721 more rows</span></span></span></code></pre></div>
<p>Let’s plot the Butterworth-smoothed trajectories.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">it01_tongue</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">knot</span> <span class="op">==</span> <span class="st">"8"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">time_annot</span>, <span class="va">Y</span>, group <span class="op">=</span> <span class="va">date_time</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">Y_smb</span><span class="op">)</span>, colour <span class="op">=</span> <span class="st">"orange"</span><span class="op">)</span></span></code></pre></div>
<p><img src="filter-signals_files/figure-html/filter-b-plot-1.png" width="672"></p>
<p>Let’s compare the Savitzky-Golay and the Butterworth filter. They
produce very similar results.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">it01_tongue</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">knot</span> <span class="op">==</span> <span class="st">"8"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">time_annot</span>, <span class="va">Y</span>, group <span class="op">=</span> <span class="va">date_time</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">Y_sm</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fl">15</span>, size <span class="op">=</span> <span class="fl">2</span>, colour <span class="op">=</span> <span class="st">"purple"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">Y_smb</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fl">18</span>, size <span class="op">=</span> <span class="fl">1</span>, colour <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">displ_id</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="filter-signals_files/figure-html/filter-both-1.png" width="672"></p>
</div>
<div class="section level2">
<h2 id="resampling">Resampling<a class="anchor" aria-label="anchor" href="#resampling"></a>
</h2>
<p>It is usually a good idea to upsample the smoothed signals especially
when one wants to calculate the velocity of the displacement signal.</p>
<p>The package rticulate provides users with a
<code><a href="../reference/resample_signal.html">resample_signal()</a></code> function that uses linear interpolation
to resample a signal. In this section, we will see how to upsample the
displacement signals of knot 8.</p>
<p>Upsampling with linear interpolation means that the upsampled signal
will have to be smoothed. We will do that at the end of this section
although the procedure is the same as the one we have seen above.</p>
<p>Let’s upsample the <code>Y_sm</code> signal. The
<code><a href="../reference/resample_signal.html">resample_signal()</a></code> function takes three main arguments:</p>
<ul>
<li>The sample to resample, here <code>Y_sm</code>.</li>
<li>The column containing the time information, here
<code>time_annot</code>.</li>
<li>The resampling factor, here <code>3</code> (meaning the sampling
rate will be increased by a factor of 3).</li>
</ul>
<p>Since resampling changes the number of rows in the tibble, we need to
use <code><a href="https://dplyr.tidyverse.org/reference/reframe.html" class="external-link">reframe()</a></code> rather than mutate. And of course we need to
use the <code>.by</code> argument so that upsampling is done for each
signal individually.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">it01_tongue_up</span> <span class="op">&lt;-</span> <span class="va">it01_tongue</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/reframe.html" class="external-link">reframe</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/resample_signal.html">resample_signal</a></span><span class="op">(</span><span class="va">Y_sm</span>, <span class="va">time_annot</span>, by <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>    .by <span class="op">=</span> <span class="va">displ_id</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Nothing exceptional here, just doing some wrangling to get the info back</span></span>
<span><span class="va">it01_tongue_up</span> <span class="op">&lt;-</span> <span class="va">it01_tongue_up</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">it01_tongue</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">Prompt</span>, <span class="va">spline</span>, <span class="va">knot</span>, <span class="va">displ_id</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>Y_sm_up <span class="op">=</span> <span class="va">signal_int</span><span class="op">)</span></span>
<span><span class="co">#&gt; Joining with `by = join_by(displ_id)`</span></span>
<span></span>
<span><span class="va">it01_tongue_up</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 17,193 × 6</span></span></span>
<span><span class="co">#&gt;    displ_id time_int Y_sm_up Prompt               spline      knot</span></span>
<span><span class="co">#&gt;       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>        5   0.008<span style="text-decoration: underline;">7</span>    32.4 Dico pada lentamente DLC_Tongue     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>        5   0.013<span style="text-decoration: underline;">6</span>    32.5 Dico pada lentamente DLC_Tongue     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>        5   0.018<span style="text-decoration: underline;">5</span>    32.6 Dico pada lentamente DLC_Tongue     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>        5   0.023<span style="text-decoration: underline;">4</span>    32.7 Dico pada lentamente DLC_Tongue     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>        5   0.028<span style="text-decoration: underline;">3</span>    32.8 Dico pada lentamente DLC_Tongue     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>        5   0.033<span style="text-decoration: underline;">1</span>    32.9 Dico pada lentamente DLC_Tongue     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>        5   0.038<span style="text-decoration: underline;">0</span>    32.9 Dico pada lentamente DLC_Tongue     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>        5   0.042<span style="text-decoration: underline;">9</span>    33.0 Dico pada lentamente DLC_Tongue     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>        5   0.047<span style="text-decoration: underline;">8</span>    33.0 Dico pada lentamente DLC_Tongue     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>        5   0.052<span style="text-decoration: underline;">7</span>    33.1 Dico pada lentamente DLC_Tongue     0</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 17,183 more rows</span></span></span></code></pre></div>
<p>Let’s plot knot 8!</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">it01_tongue_up</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">knot</span> <span class="op">==</span> <span class="fl">8</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">time_int</span>, <span class="va">Y_sm_up</span>, group <span class="op">=</span> <span class="va">displ_id</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="filter-signals_files/figure-html/upsample-plot-1.png" width="672"></p>
<p>It looks good, but we do need to apply a filter so that we get
smoother signals where the interpolation created straight lines.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">it01_tongue_up</span> <span class="op">&lt;-</span> <span class="va">it01_tongue_up</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    Y_sm_up_sm <span class="op">=</span> <span class="fu"><a href="../reference/filter_signal.html">filter_signal</a></span><span class="op">(</span><span class="va">Y_sm_up</span>, order <span class="op">=</span> <span class="fl">2</span>, window_length <span class="op">=</span> <span class="fl">7</span>, apply <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>    .by <span class="op">=</span> <span class="va">displ_id</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">it01_tongue_up</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">knot</span> <span class="op">==</span> <span class="fl">8</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">time_int</span>, <span class="va">Y_sm_up_sm</span>, group <span class="op">=</span> <span class="va">displ_id</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="filter-signals_files/figure-html/upsample-smooth-1.png" width="672"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Stefano Coretta.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
