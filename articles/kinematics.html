<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Kinematics and gestural landmarks • rticulate</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Kinematics and gestural landmarks">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">rticulate</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/filter-signals.html">Filter signals</a></li>
    <li><a class="dropdown-item" href="../articles/kinematics.html">Kinematics and gestural landmarks</a></li>
    <li><a class="dropdown-item" href="../articles/overview.html">Package overview</a></li>
    <li><a class="dropdown-item" href="../articles/polar-gams.html">Using generalised additive models (GAM) with polar coordinates for assessing tongue contours</a></li>
    <li><a class="dropdown-item" href="../articles/tongue-imaging.html">Import and plot UTI and EMA data</a></li>
    <li><a class="dropdown-item" href="../articles/transform-coord.html">Transform spline coordinates between cartesian and polar</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/stefanocoretta/rticulate/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Kinematics and gestural landmarks</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/stefanocoretta/rticulate/blob/main/vignettes/kinematics.Rmd" class="external-link"><code>vignettes/kinematics.Rmd</code></a></small>
      <div class="d-none name"><code>kinematics.Rmd</code></div>
    </div>

    
    
<p>In this vignette, we will illustrate how to extract kinematic
(gestural) landmarks from displacement signals.</p>
<div class="section level2">
<h2 id="read-the-data">Read the data<a class="anchor" aria-label="anchor" href="#read-the-data"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Attaching core tidyverse packages</span> ──────────────────────── tidyverse 2.0.0 ──</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">dplyr    </span> 1.1.4     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">readr    </span> 2.1.5</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">forcats  </span> 1.0.0     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">stringr  </span> 1.5.1</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">ggplot2  </span> 3.5.1     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">tibble   </span> 3.2.1</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">lubridate</span> 1.9.4     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">tidyr    </span> 1.3.1</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">purrr    </span> 1.0.4     </span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Conflicts</span> ────────────────────────────────────────── tidyverse_conflicts() ──</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">filter()</span> masks <span style="color: #0000BB;">stats</span>::filter()</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">lag()</span>    masks <span style="color: #0000BB;">stats</span>::lag()</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use the conflicted package (<span style="color: #0000BB; font-style: italic;">&lt;http://conflicted.r-lib.org/&gt;</span>) to force all conflicts to become errors</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/stefanocoretta/rticulate" class="external-link">rticulate</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">it01_dlc_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/it01-dlc.tsv"</span>, package <span class="op">=</span> <span class="st">"rticulate"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">it01_dlc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_aaa.html">read_aaa</a></span><span class="op">(</span><span class="va">it01_dlc_path</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="co"># Let's rename some columns.</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span></span>
<span>    date_time <span class="op">=</span> <span class="va">`Date Time of recording`</span>,</span>
<span>    time_rec <span class="op">=</span> <span class="va">`Time of sample in recording`</span>,</span>
<span>    time_annot <span class="op">=</span> <span class="va">`Time of sample in annot`</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">521</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">36</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Delimiter:</span> "\t"</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">chr</span>  (4): Client family name, Date Time of recording, Prompt, Annotation Title</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">dbl</span> (32): Time of sample in recording, Time of sample in annot, X0 DLC_Tongu...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use `spec()` to retrieve the full column specification for this data.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></span></code></pre></div>
<p>Let’s plot the smoothed and resampled displacement signal on the Y
axis of knot 8 (Blade 2).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">it01_up</span> <span class="op">&lt;-</span> <span class="va">it01_dlc</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">spline</span> <span class="op">==</span> <span class="st">"DLC_Tongue"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    Y_sm <span class="op">=</span> <span class="fu"><a href="../reference/filter_signal.html">filter_signal</a></span><span class="op">(</span><span class="va">Y</span>, order <span class="op">=</span> <span class="fl">2</span>, window_length <span class="op">=</span> <span class="fl">7</span>, apply <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>    .by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">displ_id</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/reframe.html" class="external-link">reframe</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/resample_signal.html">resample_signal</a></span><span class="op">(</span><span class="va">Y_sm</span>, <span class="va">time_annot</span>, by <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>, .by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">displ_id</span>, <span class="va">knot</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    Y_sm_up <span class="op">=</span> <span class="fu"><a href="../reference/filter_signal.html">filter_signal</a></span><span class="op">(</span><span class="va">signal_int</span>, window_length <span class="op">=</span> <span class="fl">11</span>, apply <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>    .by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">displ_id</span>, <span class="va">knot</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">it01_up</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">knot</span> <span class="op">==</span> <span class="fl">8</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">time_int</span>, <span class="va">Y_sm_up</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">displ_id</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="kinematics_files/figure-html/it01-up-1.png" width="672"></p>
</div>
<div class="section level2">
<h2 id="get-the-velocity-of-displacement">Get the velocity of displacement<a class="anchor" aria-label="anchor" href="#get-the-velocity-of-displacement"></a>
</h2>
<p>To obtain gestural landmarks, it is necessary to calculate the
velocity (i.e. the first derivative) of the displacement signal. This
package has a <code><a href="../reference/get_velocity.html">get_velocity()</a></code> function which calculates the
velocity of a signal.</p>
<p>Note that calculating the derivative of a signal returns a vector
that is one item shorter than the original signal vector we get the
derivative of. <code><a href="../reference/get_velocity.html">get_velocity()</a></code> adds a <code>NA</code> at the
beginning of the output vector to correct for that.</p>
<p>The following code chunk illustrates the use of
<code><a href="../reference/get_velocity.html">get_velocity()</a></code> on a single signal
(<code>displ_id = 14</code>) and plots the results.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">it01_up</span> <span class="op">&lt;-</span> <span class="va">it01_up</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    Y_sm_up_vel <span class="op">=</span> <span class="fu"><a href="../reference/get_velocity.html">get_velocity</a></span><span class="op">(</span><span class="va">Y_sm_up</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">it01_up</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">displ_id</span> <span class="op">==</span> <span class="fl">14</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">time_int</span>, <span class="va">Y_sm_up_vel</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">Y_sm_up_vel</span><span class="op">)</span><span class="op">)</span>, colour <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"rect"</span>, xmin <span class="op">=</span> <span class="fl">0.3</span>, xmax <span class="op">=</span> <span class="fl">0.55</span>, ymin <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>, ymax <span class="op">=</span> <span class="cn">Inf</span>, alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span></span></code></pre></div>
<p><img src="kinematics_files/figure-html/get-velocity-1.png" width="672"></p>
<p>The black dots represent the calculated velocity of the signal while
the red line is the absolute velocity (i.e. the speed). Absolute
velocity is used by the <code><a href="../reference/get_landmarks.html">get_landmarks()</a></code> function to obtain
the landmarks (you will see how to use this function in the next
section).</p>
<p>The grey area indicates the approximate location of the tongue blade
raising and lowering in the sequence /ata/.</p>
</div>
<div class="section level2">
<h2 id="gestural-landmarks">Gestural landmarks<a class="anchor" aria-label="anchor" href="#gestural-landmarks"></a>
</h2>
<p>The following schematics illustrates the relation between the
displacement signal, the velocity and absolute velocity signals, and the
gestural landmarks.</p>
<p><img src="gestures.png"></p>
<ul>
<li>
<strong>Peak 1 and peak 2</strong>: they are the peak closing
absolute velocity and peak opening absolute velocity. The time of these
landmarks indicate the time in which the displacement reaches maximum
(i.e. peak) velocity.</li>
<li>
<strong>Maximum displacement</strong>: this is the minimum absolute
velocity between peak 1 and 2, and corresponds to the time of maximum
displacement.</li>
<li>
<strong>Gesture onset and offset</strong>: these indicate the onset
and offset of the closing-opening gesture. They are calculated as the
time in which the opening absolute velocity before peak 1 is 20% of the
peak 1 absolute velocity and as the time in which the closing absolute
velocity after peak 2 is 20% of the peak 2 absolute velocity.</li>
<li>
<strong>Plateau onset and offset</strong>: these indicate the
approximate onset and offset of the displacement plateau (when the
articulator minimally moves around the time of maximum displacement).
These are calculated as the time in which the absolute velocity before
and after maximum displacement is 20% of the peak 1 and peak 2 absolute
velocities respectively.</li>
</ul>
<p>The following code illustrates the use of
<code><a href="../reference/get_landmarks.html">get_landmarks()</a></code> with the same single displacement signal
from above (<code>displ_id == 14</code>).</p>
<p>For the <code><a href="../reference/get_landmarks.html">get_landmarks()</a></code> function to function correctly,
the user has to select a time window within which the maximum
displacement (i.e. the minimum velocity) will be searched. The window
should not contain any other velocity minima. For consonants, a good
reference is the start and end of the consonant closure as obtained from
acoustics. To make things easier, here I am selecting a single window
for all displacement signals, which happens to work fine.</p>
<p>I also recommend to run the function on the signal within a reduced
time window which includes the opening-closing gesture only. This will
help reducing the erroneous detection of other peaks/minima in the
signal.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Filter signal to include a reduced time window</span></span>
<span><span class="va">it01_up_win</span> <span class="op">&lt;-</span> <span class="va">it01_up</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">displ_id</span> <span class="op">==</span> <span class="fl">14</span>, <span class="va">time_int</span> <span class="op">&gt;</span> <span class="fl">0.3</span>, <span class="va">time_int</span> <span class="op">&lt;</span> <span class="fl">0.55</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get landmarks</span></span>
<span><span class="va">it01_up_win_land</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_landmarks.html">get_landmarks</a></span><span class="op">(</span><span class="va">it01_up_win</span><span class="op">$</span><span class="va">Y_sm_up_vel</span>, <span class="va">it01_up_win</span><span class="op">$</span><span class="va">time_int</span>, <span class="fl">0.4</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="va">it01_up_win_land_long</span> <span class="op">&lt;-</span> <span class="va">it01_up_win_land</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"land"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">it01_up_win_land_long</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 14 × 2</span></span></span>
<span><span class="co">#&gt;    land           value</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> min_1_vel     0.019<span style="text-decoration: underline;">9</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> peak_1_vel    0.562 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> max_disp_vel  0     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> peak_2_vel    0.494 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> min_3_vel     0     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> min_1_time    0.317 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> peak_1_time   0.390 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> max_disp_time 0.448 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> peak_2_time   0.488 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> min_3_time    0.526 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> GEST_ons      0.336 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> PLAT_ons      0.441 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> PLAT_off      0.454 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> GEST_off      0.522</span></span></code></pre></div>
<p>The following plots show the gestural landmarks overlaid on the
absolute velocity (top) and on the displacement (bottom).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">it01_up_win</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">time_int</span>, <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fu"><a href="../reference/get_velocity.html">get_velocity</a></span><span class="op">(</span><span class="va">Y_sm_up</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">it01_up_win_land_long</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">land</span>, <span class="st">"_ons|_off"</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Absolute velocity"</span><span class="op">)</span></span></code></pre></div>
<p><img src="kinematics_files/figure-html/plot-landmarks-1.png" width="672"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">it01_up_win</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">time_int</span>, <span class="va">Y_sm_up</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">it01_up_win_land_long</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">land</span>, <span class="st">"_ons|_off"</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Y displacement"</span><span class="op">)</span></span></code></pre></div>
<p><img src="kinematics_files/figure-html/plot-landmarks-2.png" width="672"></p>
<p>Let’s now get gestural landmarks for all the knot 8 data.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">it01_up_lands</span> <span class="op">&lt;-</span> <span class="va">it01_up</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">knot</span> <span class="op">==</span> <span class="fl">8</span>, <span class="va">time_int</span> <span class="op">&gt;</span> <span class="fl">0.3</span>, <span class="va">time_int</span> <span class="op">&lt;</span> <span class="fl">0.55</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/reframe.html" class="external-link">reframe</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/get_landmarks.html">get_landmarks</a></span><span class="op">(</span><span class="va">Y_sm_up_vel</span>, <span class="va">time_int</span>, <span class="fl">0.35</span>, <span class="fl">0.45</span><span class="op">)</span>,</span>
<span>    .by <span class="op">=</span> <span class="va">displ_id</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">it01_up_lands</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 12 × 15</span></span></span>
<span><span class="co">#&gt;    displ_id min_1_vel peak_1_vel max_disp_vel peak_2_vel min_3_vel min_1_time</span></span>
<span><span class="co">#&gt;       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>       13    0           0.526      0.009<span style="text-decoration: underline;">79</span>      0.391         0      0.323</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>       28    0.241       0.687      0            0.306         0      0.306</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>       43    0           0.549      0            0.397         0      0.311</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>       58    0.067<span style="text-decoration: underline;">6</span>      0.598      0            0.506         0      0.305</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>       73    0.113       0.706      0            0.446         0      0.303</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>       88    0.212       0.632      0            0.374         0      0.305</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>      103    0.166       0.648      0            0.419         0      0.303</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>      118    0.513       0.665      0            0.478         0      0.301</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>      133    0.393       0.606      0            0.446         0      0.304</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>      148    0.533       0.607      0            0.316         0      0.302</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span>      163    0.389       0.574      0            0.444         0      0.303</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span>      178    0.410       0.590      0            0.375         0      0.303</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 8 more variables: peak_1_time &lt;dbl&gt;, max_disp_time &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   peak_2_time &lt;dbl&gt;, min_3_time &lt;dbl&gt;, GEST_ons &lt;dbl&gt;, PLAT_ons &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   PLAT_off &lt;dbl&gt;, GEST_off &lt;dbl&gt;</span></span></span></code></pre></div>
<p>And finally, let’s plot the gestural landmarks!</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">it01_up_lands_long</span> <span class="op">&lt;-</span> <span class="va">it01_up_lands</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="op">-</span><span class="va">displ_id</span>, names_to <span class="op">=</span> <span class="st">"land"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">it01_up</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">knot</span> <span class="op">==</span> <span class="fl">8</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">time_int</span>, <span class="va">Y_sm_up</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">it01_up_lands_long</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">land</span>, <span class="st">"_ons|_off"</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">displ_id</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 1 row containing missing values or values outside the scale range</span></span>
<span><span class="co">#&gt; (`geom_vline()`).</span></span></code></pre></div>
<p><img src="kinematics_files/figure-html/unnamed-chunk-2-1.png" width="672"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Stefano Coretta.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
